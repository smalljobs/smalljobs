
%h2= "Aktivitäten"
%p
  = allocations_with_numbers(@seeker)
%p
  = total_amount_earned_in_assignment(@seeker)
%br

- allocations = @seeker.allocations.active.where.not(job: nil).where.not(provider: nil)
- if allocations.count > 0
  %h4#active
    = "Aktive Anstellungen"
  %ul.allocations-list
    - for allocation in allocations
      - if !allocation.job.nil? && !allocation.job.provider.nil?
        %li.allocations-list-item
          %p
            = link_to "#{allocation.job.provider.name}, #{allocation.job.title}, #{allocation.last_change_of_state.strftime("%d.%m.%Y")}", broker_job_allocation_path(allocation.job, allocation.seeker)




- allocations = @seeker.allocations.application_open.where.not(job: nil).where.not(provider: nil)
- if allocations.count > 0
  %h4#application_open
    = "Bewerbungen"
  %ul.allocations-list
    - for allocation in allocations
      - if !allocation.job.nil? && !allocation.job.provider.nil?
        %li.allocations-list-itemf
          %p
            = link_to "#{allocation.job.provider.name}, #{allocation.job.title}, #{allocation.last_change_of_state.strftime("%d.%m.%Y")}", broker_job_allocation_path(allocation.job, allocation.seeker)

- allocations = @seeker.allocations.proposal.where.not(job: nil).where.not(provider: nil)
- if allocations.count > 0
  %h4#proposal
    = "Job Vorschläge"
  %ul.allocations-list
    - for allocation in allocations
      - if !allocation.job.nil? && !allocation.job.provider.nil?
        %li.allocations-list-item
          %p
            = link_to "#{allocation.job.provider.name}, #{allocation.job.title}, #{allocation.last_change_of_state.strftime("%d.%m.%Y")}", broker_job_allocation_path(allocation.job, allocation.seeker)

- allocations = @seeker.allocations.cancelled.where.not(job: nil).where.not(provider: nil)
- if allocations.count > 0
  %h4#cancelled
    = "Abgebrochene Anstellungen"
  %ul.allocations-list
    - for allocation in allocations
      - if !allocation.job.nil? && !allocation.job.provider.nil?
        %li.allocations-list-item
          %p
            = link_to "#{allocation.job.provider.name}, #{allocation.job.title}, #{allocation.last_change_of_state.strftime("%d.%m.%Y")}", broker_job_allocation_path(allocation.job, allocation.seeker)



- allocations = @seeker.allocations.application_rejected.where.not(job: nil).where.not(provider: nil)
- if allocations.count > 0
  %h4#application_rejected
    = "Bewerbungen abgelehnt"
  %ul.allocations-list
    - for allocation in allocations
      - if !allocation.job.nil? && !allocation.job.provider.nil?
        %li.allocations-list-item
          %p
            = link_to "#{allocation.job.provider.name}, #{allocation.job.title}, #{allocation.last_change_of_state.strftime("%d.%m.%Y")}", broker_job_allocation_path(allocation.job, allocation.seeker)

- allocations = @seeker.allocations.application_retracted.where.not(job: nil).where.not(provider: nil)
- if allocations.count > 0
  %h4#application_retracted
    = "Zurückgezogene Bewerbungen"
  %ul.allocations-list
    - for allocation in allocations
      - if !allocation.job.nil? && !allocation.job.provider.nil?
        %li.allocations-list-item
          %p
            = link_to "#{allocation.job.provider.name}, #{allocation.job.title}, #{allocation.last_change_of_state.strftime("%d.%m.%Y")}", broker_job_allocation_path(allocation.job, allocation.seeker)

- allocations = @seeker.allocations.finished.where.not(job: nil).where.not(provider: nil)
- if allocations.count > 0
  %h4#finished
    = "Beendete Anstellungen"
  %ul.allocations-list
    - for allocation in allocations
      - if !allocation.job.nil? && !allocation.job.provider.nil?
        %li.allocations-list-item
          %p
            = link_to "#{allocation.job.provider.name}, #{allocation.job.title}, #{allocation.last_change_of_state.strftime("%d.%m.%Y")}", broker_job_allocation_path(allocation.job, allocation.seeker)

